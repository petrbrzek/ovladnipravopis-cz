datasource db {
    provider = env("PRISMA_PROVIDER")
    url      = env("PRISMA_URL")
}

generator photon {
    provider = "photonjs"
}

model User {
    id                  String      @default(cuid()) @id @unique
    email               String      @unique
    password            String
    resetPasswordToken  String?     @unique
    resetPasswordExpire Float?
    createdAt           DateTime    @default(now())
    updatedAt           DateTime    @updatedAt
    name                String?
    exercises           Exercise[]
    levels              Level[]
    stats               UserStats[]
}

model UserStats {
    id        String        @default(cuid()) @id @unique
    createdAt DateTime      @default(now())
    updatedAt DateTime      @updatedAt
    user      User
    exercise  Exercise
    state     ExerciseState
    card      Card?
}

enum ExerciseState {
    OPEN
    FAILED
    FINISHED
}

model Exercise {
    id        String      @default(cuid()) @id @unique
    published Boolean
    title     String
    content   String?
    level     Level?
    cards     Card[]
    stats     UserStats[]
    users     User[]
    createdAt DateTime    @default(now())
    updatedAt DateTime    @updatedAt
}

model Card {
    id        String      @default(cuid()) @id @unique
    published Boolean
    content   String
    correct   Boolean
    createdAt DateTime    @default(now())
    updatedAt DateTime    @updatedAt
    stats     UserStats[]
}

model Level {
    id        String     @default(cuid()) @id @unique
    levelId   String     @unique
    rank      String?
    published Boolean
    title     String
    exercises Exercise[]
    users     User[]
    createdAt DateTime   @default(now())
    updatedAt DateTime   @updatedAt
}